FROM node:16.17.1-alpine3.15

ARG APP_NAME
ARG LANGS
ARG DOMAIN
ARG DOMAIN_MEDIA
ARG DOMAIN_API
ARG CURRENCY_SYMBOL

ENV APP_NAME $APP_NAME
ENV LANGS  $LANGS
ENV DOMAIN $DOMAIN
ENV DOMAIN_MEDIA $DOMAIN_MEDIA
ENV DOMAIN_API $DOMAIN_API
ENV CURRENCY_SYMBOL $CURRENCY_SYMBOL

ENV PORT 80

ENV NODE_OPTIONS=--max_old_space_size=4096

WORKDIR /app

COPY package.json package-lock.json ./

RUN npm install

COPY . .

RUN npm run build:universal

CMD npm run server
